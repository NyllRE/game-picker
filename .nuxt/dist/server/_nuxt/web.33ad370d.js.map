{"version":3,"file":"web.33ad370d.js","sources":["../../../../node_modules/@capacitor/camera/dist/esm/web.js"],"sourcesContent":["import { WebPlugin, CapacitorException } from '@capacitor/core';\nimport { CameraSource, CameraDirection } from './definitions';\nexport class CameraWeb extends WebPlugin {\n    async getPhoto(options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve, reject) => {\n            if (options.webUseInput || options.source === CameraSource.Photos) {\n                this.fileInputExperience(options, resolve);\n            }\n            else if (options.source === CameraSource.Prompt) {\n                let actionSheet = document.querySelector('pwa-action-sheet');\n                if (!actionSheet) {\n                    actionSheet = document.createElement('pwa-action-sheet');\n                    document.body.appendChild(actionSheet);\n                }\n                actionSheet.header = options.promptLabelHeader || 'Photo';\n                actionSheet.cancelable = false;\n                actionSheet.options = [\n                    { title: options.promptLabelPhoto || 'From Photos' },\n                    { title: options.promptLabelPicture || 'Take Picture' },\n                ];\n                actionSheet.addEventListener('onSelection', async (e) => {\n                    const selection = e.detail;\n                    if (selection === 0) {\n                        this.fileInputExperience(options, resolve);\n                    }\n                    else {\n                        this.cameraExperience(options, resolve, reject);\n                    }\n                });\n            }\n            else {\n                this.cameraExperience(options, resolve, reject);\n            }\n        });\n    }\n    async pickImages(_options) {\n        // eslint-disable-next-line no-async-promise-executor\n        return new Promise(async (resolve) => {\n            this.multipleFileInputExperience(resolve);\n        });\n    }\n    async cameraExperience(options, resolve, reject) {\n        if (customElements.get('pwa-camera-modal')) {\n            const cameraModal = document.createElement('pwa-camera-modal');\n            cameraModal.facingMode =\n                options.direction === CameraDirection.Front ? 'user' : 'environment';\n            document.body.appendChild(cameraModal);\n            try {\n                await cameraModal.componentOnReady();\n                cameraModal.addEventListener('onPhoto', async (e) => {\n                    const photo = e.detail;\n                    if (photo === null) {\n                        reject(new CapacitorException('User cancelled photos app'));\n                    }\n                    else if (photo instanceof Error) {\n                        reject(photo);\n                    }\n                    else {\n                        resolve(await this._getCameraPhoto(photo, options));\n                    }\n                    cameraModal.dismiss();\n                    document.body.removeChild(cameraModal);\n                });\n                cameraModal.present();\n            }\n            catch (e) {\n                this.fileInputExperience(options, resolve);\n            }\n        }\n        else {\n            console.error(`Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements.`);\n            this.fileInputExperience(options, resolve);\n        }\n    }\n    fileInputExperience(options, resolve) {\n        let input = document.querySelector('#_capacitor-camera-input');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input';\n            input.type = 'file';\n            input.hidden = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const file = input.files[0];\n                let format = 'jpeg';\n                if (file.type === 'image/png') {\n                    format = 'png';\n                }\n                else if (file.type === 'image/gif') {\n                    format = 'gif';\n                }\n                if (options.resultType === 'dataUrl' ||\n                    options.resultType === 'base64') {\n                    const reader = new FileReader();\n                    reader.addEventListener('load', () => {\n                        if (options.resultType === 'dataUrl') {\n                            resolve({\n                                dataUrl: reader.result,\n                                format,\n                            });\n                        }\n                        else if (options.resultType === 'base64') {\n                            const b64 = reader.result.split(',')[1];\n                            resolve({\n                                base64String: b64,\n                                format,\n                            });\n                        }\n                        cleanup();\n                    });\n                    reader.readAsDataURL(file);\n                }\n                else {\n                    resolve({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                    cleanup();\n                }\n            });\n        }\n        input.accept = 'image/*';\n        input.capture = true;\n        if (options.source === CameraSource.Photos ||\n            options.source === CameraSource.Prompt) {\n            input.removeAttribute('capture');\n        }\n        else if (options.direction === CameraDirection.Front) {\n            input.capture = 'user';\n        }\n        else if (options.direction === CameraDirection.Rear) {\n            input.capture = 'environment';\n        }\n        input.click();\n    }\n    multipleFileInputExperience(resolve) {\n        let input = document.querySelector('#_capacitor-camera-input-multiple');\n        const cleanup = () => {\n            var _a;\n            (_a = input.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(input);\n        };\n        if (!input) {\n            input = document.createElement('input');\n            input.id = '_capacitor-camera-input-multiple';\n            input.type = 'file';\n            input.hidden = true;\n            input.multiple = true;\n            document.body.appendChild(input);\n            input.addEventListener('change', (_e) => {\n                const photos = [];\n                // eslint-disable-next-line @typescript-eslint/prefer-for-of\n                for (let i = 0; i < input.files.length; i++) {\n                    const file = input.files[i];\n                    let format = 'jpeg';\n                    if (file.type === 'image/png') {\n                        format = 'png';\n                    }\n                    else if (file.type === 'image/gif') {\n                        format = 'gif';\n                    }\n                    photos.push({\n                        webPath: URL.createObjectURL(file),\n                        format: format,\n                    });\n                }\n                resolve({ photos });\n                cleanup();\n            });\n        }\n        input.accept = 'image/*';\n        input.click();\n    }\n    _getCameraPhoto(photo, options) {\n        return new Promise((resolve, reject) => {\n            const reader = new FileReader();\n            const format = photo.type.split('/')[1];\n            if (options.resultType === 'uri') {\n                resolve({\n                    webPath: URL.createObjectURL(photo),\n                    format: format,\n                    saved: false,\n                });\n            }\n            else {\n                reader.readAsDataURL(photo);\n                reader.onloadend = () => {\n                    const r = reader.result;\n                    if (options.resultType === 'dataUrl') {\n                        resolve({\n                            dataUrl: r,\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                    else {\n                        resolve({\n                            base64String: r.split(',')[1],\n                            format: format,\n                            saved: false,\n                        });\n                    }\n                };\n                reader.onerror = e => {\n                    reject(e);\n                };\n            }\n        });\n    }\n    async checkPermissions() {\n        if (typeof navigator === 'undefined' || !navigator.permissions) {\n            throw this.unavailable('Permissions API not available in this browser');\n        }\n        try {\n            // https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query\n            // the specific permissions that are supported varies among browsers that implement the\n            // permissions API, so we need a try/catch in case 'camera' is invalid\n            const permission = await window.navigator.permissions.query({\n                name: 'camera',\n            });\n            return {\n                camera: permission.state,\n                photos: 'granted',\n            };\n        }\n        catch (_a) {\n            throw this.unavailable('Camera permissions are not available in this browser');\n        }\n    }\n    async requestPermissions() {\n        throw this.unimplemented('Not implemented on web.');\n    }\n    async pickLimitedLibraryPhotos() {\n        throw this.unavailable('Not implemented on web.');\n    }\n    async getLimitedLibraryPhotos() {\n        throw this.unavailable('Not implemented on web.');\n    }\n}\nconst Camera = new CameraWeb();\nexport { Camera };\n//# sourceMappingURL=web.js.map"],"names":["CameraWeb","WebPlugin","options","resolve","reject","CameraSource","actionSheet","e","_options","cameraModal","CameraDirection","photo","CapacitorException","input","cleanup","_a","_e","file","format","reader","b64","photos","i","r","Camera"],"mappings":"qKAEO,MAAMA,UAAkBC,CAAU,CACrC,MAAM,SAASC,EAAS,CAEpB,OAAO,IAAI,QAAQ,MAAOC,EAASC,IAAW,CAC1C,GAAIF,EAAQ,aAAeA,EAAQ,SAAWG,EAAa,OACvD,KAAK,oBAAoBH,EAASC,CAAO,UAEpCD,EAAQ,SAAWG,EAAa,OAAQ,CAC7C,IAAIC,EAAc,SAAS,cAAc,kBAAkB,EACtDA,IACDA,EAAc,SAAS,cAAc,kBAAkB,EACvD,SAAS,KAAK,YAAYA,CAAW,GAEzCA,EAAY,OAASJ,EAAQ,mBAAqB,QAClDI,EAAY,WAAa,GACzBA,EAAY,QAAU,CAClB,CAAE,MAAOJ,EAAQ,kBAAoB,aAAe,EACpD,CAAE,MAAOA,EAAQ,oBAAsB,cAAgB,CAC3E,EACgBI,EAAY,iBAAiB,cAAe,MAAOC,GAAM,CACnCA,EAAE,SACF,EACd,KAAK,oBAAoBL,EAASC,CAAO,EAGzC,KAAK,iBAAiBD,EAASC,EAASC,CAAM,CAEtE,CAAiB,CACJ,MAEG,KAAK,iBAAiBF,EAASC,EAASC,CAAM,CAE9D,CAAS,CACJ,CACD,MAAM,WAAWI,EAAU,CAEvB,OAAO,IAAI,QAAQ,MAAOL,GAAY,CAClC,KAAK,4BAA4BA,CAAO,CACpD,CAAS,CACJ,CACD,MAAM,iBAAiBD,EAASC,EAASC,EAAQ,CAC7C,GAAI,eAAe,IAAI,kBAAkB,EAAG,CACxC,MAAMK,EAAc,SAAS,cAAc,kBAAkB,EAC7DA,EAAY,WACRP,EAAQ,YAAcQ,EAAgB,MAAQ,OAAS,cAC3D,SAAS,KAAK,YAAYD,CAAW,EACrC,GAAI,CACA,MAAMA,EAAY,mBAClBA,EAAY,iBAAiB,UAAW,MAAOF,GAAM,CACjD,MAAMI,EAAQJ,EAAE,OACZI,IAAU,KACVP,EAAO,IAAIQ,EAAmB,2BAA2B,CAAC,EAErDD,aAAiB,MACtBP,EAAOO,CAAK,EAGZR,EAAQ,MAAM,KAAK,gBAAgBQ,EAAOT,CAAO,CAAC,EAEtDO,EAAY,QAAO,EACnB,SAAS,KAAK,YAAYA,CAAW,CACzD,CAAiB,EACDA,EAAY,QAAO,CACtB,MACD,CACI,KAAK,oBAAoBP,EAASC,CAAO,CAC5C,CACJ,MAEG,QAAQ,MAAM,6GAA6G,EAC3H,KAAK,oBAAoBD,EAASC,CAAO,CAEhD,CACD,oBAAoBD,EAASC,EAAS,CAClC,IAAIU,EAAQ,SAAS,cAAc,0BAA0B,EAC7D,MAAMC,EAAU,IAAM,CAClB,IAAIC,GACHA,EAAKF,EAAM,cAAgB,MAAQE,IAAO,QAAkBA,EAAG,YAAYF,CAAK,CAC7F,EACaA,IACDA,EAAQ,SAAS,cAAc,OAAO,EACtCA,EAAM,GAAK,0BACXA,EAAM,KAAO,OACbA,EAAM,OAAS,GACf,SAAS,KAAK,YAAYA,CAAK,EAC/BA,EAAM,iBAAiB,SAAWG,GAAO,CACrC,MAAMC,EAAOJ,EAAM,MAAM,GACzB,IAAIK,EAAS,OAOb,GANID,EAAK,OAAS,YACdC,EAAS,MAEJD,EAAK,OAAS,cACnBC,EAAS,OAEThB,EAAQ,aAAe,WACvBA,EAAQ,aAAe,SAAU,CACjC,MAAMiB,EAAS,IAAI,WACnBA,EAAO,iBAAiB,OAAQ,IAAM,CAClC,GAAIjB,EAAQ,aAAe,UACvBC,EAAQ,CACJ,QAASgB,EAAO,OAChB,OAAAD,CAChC,CAA6B,UAEIhB,EAAQ,aAAe,SAAU,CACtC,MAAMkB,EAAMD,EAAO,OAAO,MAAM,GAAG,EAAE,GACrChB,EAAQ,CACJ,aAAciB,EACd,OAAAF,CAChC,CAA6B,CACJ,CACDJ,GACxB,CAAqB,EACDK,EAAO,cAAcF,CAAI,CAC5B,MAEGd,EAAQ,CACJ,QAAS,IAAI,gBAAgBc,CAAI,EACjC,OAAQC,CAChC,CAAqB,EACDJ,GAEpB,CAAa,GAELD,EAAM,OAAS,UACfA,EAAM,QAAU,GACZX,EAAQ,SAAWG,EAAa,QAChCH,EAAQ,SAAWG,EAAa,OAChCQ,EAAM,gBAAgB,SAAS,EAE1BX,EAAQ,YAAcQ,EAAgB,MAC3CG,EAAM,QAAU,OAEXX,EAAQ,YAAcQ,EAAgB,OAC3CG,EAAM,QAAU,eAEpBA,EAAM,MAAK,CACd,CACD,4BAA4BV,EAAS,CACjC,IAAIU,EAAQ,SAAS,cAAc,mCAAmC,EACtE,MAAMC,EAAU,IAAM,CAClB,IAAIC,GACHA,EAAKF,EAAM,cAAgB,MAAQE,IAAO,QAAkBA,EAAG,YAAYF,CAAK,CAC7F,EACaA,IACDA,EAAQ,SAAS,cAAc,OAAO,EACtCA,EAAM,GAAK,mCACXA,EAAM,KAAO,OACbA,EAAM,OAAS,GACfA,EAAM,SAAW,GACjB,SAAS,KAAK,YAAYA,CAAK,EAC/BA,EAAM,iBAAiB,SAAWG,GAAO,CACrC,MAAMK,EAAS,CAAA,EAEf,QAASC,EAAI,EAAGA,EAAIT,EAAM,MAAM,OAAQS,IAAK,CACzC,MAAML,EAAOJ,EAAM,MAAMS,GACzB,IAAIJ,EAAS,OACTD,EAAK,OAAS,YACdC,EAAS,MAEJD,EAAK,OAAS,cACnBC,EAAS,OAEbG,EAAO,KAAK,CACR,QAAS,IAAI,gBAAgBJ,CAAI,EACjC,OAAQC,CAChC,CAAqB,CACJ,CACDf,EAAQ,CAAE,OAAAkB,CAAM,CAAE,EAClBP,GAChB,CAAa,GAELD,EAAM,OAAS,UACfA,EAAM,MAAK,CACd,CACD,gBAAgBF,EAAOT,EAAS,CAC5B,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CACpC,MAAMe,EAAS,IAAI,WACbD,EAASP,EAAM,KAAK,MAAM,GAAG,EAAE,GACjCT,EAAQ,aAAe,MACvBC,EAAQ,CACJ,QAAS,IAAI,gBAAgBQ,CAAK,EAClC,OAAQO,EACR,MAAO,EAC3B,CAAiB,GAGDC,EAAO,cAAcR,CAAK,EAC1BQ,EAAO,UAAY,IAAM,CACrB,MAAMI,EAAIJ,EAAO,OACbjB,EAAQ,aAAe,UACvBC,EAAQ,CACJ,QAASoB,EACT,OAAQL,EACR,MAAO,EACnC,CAAyB,EAGDf,EAAQ,CACJ,aAAcoB,EAAE,MAAM,GAAG,EAAE,GAC3B,OAAQL,EACR,MAAO,EACnC,CAAyB,CAEzB,EACgBC,EAAO,QAAUZ,GAAK,CAClBH,EAAOG,CAAC,CAC5B,EAEA,CAAS,CACJ,CACD,MAAM,kBAAmB,CAEjB,MAAM,KAAK,YAAY,+CAA+C,CAiB7E,CACD,MAAM,oBAAqB,CACvB,MAAM,KAAK,cAAc,yBAAyB,CACrD,CACD,MAAM,0BAA2B,CAC7B,MAAM,KAAK,YAAY,yBAAyB,CACnD,CACD,MAAM,yBAA0B,CAC5B,MAAM,KAAK,YAAY,yBAAyB,CACnD,CACL,CACK,MAACiB,EAAS,IAAIxB"}